<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Online - Frutas Ex√≥ticas</title>
    <link rel="stylesheet" href="Styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <!-- Encabezado -->
    <header class="bg-green-800 text-white p-4 flex justify-between items-center shadow-md">
        <div class="flex items-center space-x-3">
            <img src="imagenes/Logo.png" alt="Logo Tienda Esmeralda" class="logo-header">
            <h1 class="text-2xl font-bold">Tienda Esmeralda</h1>
        </div>
        
        <div class="flex items-center space-x-4">
            <!-- Selector de unidad -->
            <select id="unit-selector" class="bg-white text-black px-2 py-1 rounded" onchange="updateUnit()">
                <option value="kg">Kilos</option>
                <option value="lb">Libras</option>
            </select>

            <!-- Carrito -->
            <div class="relative flex items-center space-x-2">
                <button onclick="window.location.href='seccion3.html'" class="text-2xl">üõí</button>
                <span id="cart-counter" class="bg-red-500 text-white text-sm font-bold rounded-full px-2 py-1">0 kg</span>
            </div>
        </div>
    </header>

    <div class="flex">
        <div class="flex">
            <!-- Barra lateral -->
            <aside class="sidebar">
                <h2 class="sidebar-title">Men√∫ Principal</h2>
                <button onclick="window.location.href='index.html'" class="sidebar-button">
                    <i>üè†</i> Inicio
                </button>
                <button onclick="window.location.href='seccion2.html'" class="sidebar-button">
                    <i>üõçÔ∏è</i> Cat√°logo
                </button>
                </button>
                <button onclick="window.location.href='seccion4.html'" class="sidebar-button">
                    <i>üìû</i> Contacto
                </button>
            </aside>
            

        <main class="w-4/5 p-4 m-4 content-overlay">
            <h2 class="text-2xl font-bold text-green-800 mb-4">üçç Frutas Ex√≥ticas</h2>
            <p class="text-gray-700 mb-4">Descubre nuestra selecci√≥n de frutas tropicales √∫nicas y deliciosas.</p>
            <div class="grid grid-cols-4 gap-4" id="exotic-products"></div>

            <h2 class="text-2xl font-bold text-green-800 mt-8 mb-4">üî• Ofertas Especiales</h2>
            <p class="text-gray-700 mb-4">Aprovecha nuestros descuentos en productos seleccionados.</p>
            <div class="grid grid-cols-4 gap-4" id="offer-products"></div>
        </main>
    </div>

    <div id="product-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded shadow-lg max-w-md text-center relative">
            <button class="absolute top-2 right-2 text-gray-600 text-xl" onclick="closeModal()">‚úñ</button>
            <img id="modal-image" src="" alt="Producto" class="w-40 mx-auto mb-4 rounded-lg">
            <h2 id="modal-title" class="text-xl font-bold"></h2>
            <p id="modal-description" class="mt-2 text-gray-700"></p>
        </div>
    </div>

    <script>
        const exoticProducts = [
            { id: "14", name: "Pitahaya", pricePerKg: 15000, pricePerLb: Math.round(15000 / 2.20462), image: "imagenes/pitahaya.jpg", description: "Fruta tropical dulce y jugosa." },
            { id: "15", name: "Mangostino", pricePerKg: 18000, pricePerLb: Math.round(18000 / 2.20462), image: "imagenes/mangostino.jpg", description: "Conocida como la reina de las frutas." },
            { id: "16", name: "Rambut√°n", pricePerKg: 16000, pricePerLb: Math.round(16000 / 2.20462), image: "imagenes/rambutan.jpg", description: "Similar al lichi, con un sabor dulce." },
            { id: "17", name: "Maracuy√°", pricePerKg: 10000, pricePerLb: Math.round(10000 / 2.20462), image: "imagenes/maracuya.jpg", description: "Fruta con un sabor √°cido y refrescante." },
            { id: "18", name: "Noni", pricePerKg: 20000, pricePerLb: Math.round(20000 / 2.20462), image: "imagenes/noni.jpg", description: "Fruta con propiedades medicinales y alto contenido antioxidante." },
            { id: "19", name: "Guayusa", pricePerKg: 12000, pricePerLb: Math.round(12000 / 2.20462), image: "imagenes/guayusa.jpg", description: "Hoja amaz√≥nica con efectos energizantes, ideal para infusiones." },
            { id: "20", name: "A√ßai", pricePerKg: 22000, pricePerLb: Math.round(22000 / 2.20462), image: "imagenes/acai.jpg", description: "Superfruta rica en antioxidantes, popular en batidos y bowls saludables." },
            { id: "21", name: "Lulo", pricePerKg: 9000, pricePerLb: Math.round(9000 / 2.20462), image: "imagenes/lulo.jpg", description: "Fruta c√≠trica y refrescante, perfecta para jugos naturales." },
        ];

        const offerProducts = [
            { id: "22", name: "Aguacate", pricePerKg: 12000, pricePerLb: Math.round(12000 / 2.20462), image: "imagenes/aguacate.jpg", discount: "10%", description: "Rico en grasas saludables." },
            { id: "23", name: "Papaya", pricePerKg: 8000, pricePerLb: Math.round(8000 / 2.20462), image: "imagenes/papaya.jpg", discount: "15%", description: "Dulce y excelente para la digesti√≥n." },
            { id: "24", name: "Sand√≠a", pricePerKg: 7000, pricePerLb: Math.round(7000 / 2.20462), image: "imagenes/sandia.jpg", discount: "20%", description: "Refrescante y jugosa en d√≠as calurosos." },
            { id: "25", name: "Mora", pricePerKg: 6000, pricePerLb: Math.round(6000 / 2.20462), image: "imagenes/mora.jpg", discount: "12%", description: "Fruta rica en antioxidantes y fibra." },
        ];


        let cart = JSON.parse(localStorage.getItem("cart")) || {};
        let unit = localStorage.getItem("unit") || "kg";


        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("unit-selector").value = unit;
            updateCartCounter();
            renderProducts();
        });

        function renderProducts() {
            document.getElementById("exotic-products").innerHTML = 
                exoticProducts.map(product => createProductHTML(product)).join("");
            
            document.getElementById("offer-products").innerHTML = 
                offerProducts.map(product => createProductHTML(product, true)).join("");
        }

        function createProductHTML(product, isOffer = false) {
            const price = unit === "kg" ? product.pricePerKg : product.pricePerLb;
            return `
                <div class="product-card p-4 rounded flex flex-col items-center relative">
                    ${isOffer ? `<span class='bg-yellow-500 text-white text-xs px-2 py-1 rounded-full absolute top-2 left-2'>${product.discount} de descuento</span>` : ''}
                    <img src="${product.image}" alt="${product.name}" class="w-full h-32 object-cover cursor-pointer rounded-t-lg" onclick="showDescription('${product.id}')">
                    <p class="text-center mt-2 font-bold">${product.name}</p>
                    <p class="text-center">$${price}/${unit}</p>
                    <div class="flex justify-center items-center mt-2">
                        <button class="bg-orange-300 p-2 rounded" onclick="decrease('${product.id}')">-</button>
                        <span id="count-${product.id}" class="mx-2">${cart[product.id] || 0}</span>
                        <button class="bg-orange-300 p-2 rounded" onclick="increase('${product.id}')">+</button>
                    </div>
                </div>
            `;
        }

        // Funciones del carrito
        function increase(id) {
            cart[id] = (cart[id] || 0) + 0.5;
            updateStorage();
            document.getElementById(`count-${id}`).innerText = cart[id];
            updateCartCounter();
        }

        function decrease(id) {
            if (cart[id] > 0) {
                cart[id] -= 0.5;
                if (cart[id] <= 0) delete cart[id];
                updateStorage();
                document.getElementById(`count-${id}`).innerText = cart[id] || 0;
                updateCartCounter();
            }
        }

        function updateStorage() {
            localStorage.setItem("cart", JSON.stringify(cart));
        }

        function updateCartCounter() {
            const totalWeight = Object.values(cart).reduce((sum, count) => sum + count, 0);
            document.getElementById("cart-counter").innerText = `${totalWeight.toFixed(1)} ${unit}`;
        }

        function updateUnit() {
            unit = document.getElementById("unit-selector").value;
            localStorage.setItem("unit", unit);
            renderProducts();
            updateCartCounter();
        }

        function showDescription(id) {
            const product = [...exoticProducts, ...offerProducts].find(p => p.id === id);
            if (product) {
                document.getElementById("modal-title").innerText = product.name;
                document.getElementById("modal-description").innerText = product.description;
                document.getElementById("modal-image").src = product.image;
                document.getElementById("product-modal").classList.remove("hidden");
            }
        }

        function closeModal() {
            document.getElementById("product-modal").classList.add("hidden");
        }
    </script>
</body>
</html>